% REQUIRED PACKAGES:
%		\usepackage{listings}
\usepackage{lmodern}
\usepackage[T1]{fontenc}

\def\codelistingtextsize{\fontsize{9pt}{10.8pt}}
\def\inlinetextsize{\fontsize{12pt}{14.4pt}}
\def\ruletextsize{\fontsize{9pt}{10.8pt}}
\def\rulecelltextsize{\fontsize{8pt}{9.6pt}}

\def\jmltextsize{\fontsize{10pt}{12pt}}
\def\javalistPresentTextSize{\fontsize{10pt}{12pt}}
\def\codeinlinetextsize{\fontsize{9pt}{10.8pt}}

% extends \codem to allow color parameter (param #2)
%\newcommand{\codemx}[2]{\textbf{\color{#2}#1}}

%highlighted technical term (e.g. used in code listing)
\newcommand{\hterm}[1]{\codemx{#1}{blue}}

% technical term with bold face
\newcommand{\bfterm}[1]{\codemx{#1}{black}}

%styles:
\def\javalistPresentSmall{\fontsize{8pt}{9.6pt}\ttfamily}

% Code listing set up for Java language

% listing style: Java presentation (used in presentation slides)
\lstdefinestyle{JavaListingNormal}{
 xleftmargin=0.5cm,
 frame=lines,
 basicstyle=\codelistingtextsize\ttfamily,
 otherkeywords={DClass, DAttr, DOpt, DAssoc, AttrRef,
                ModuleDesc, ModelDesc, ViewDesc, AttributeDesc, ControllerDesc, 
                ContainmentTree, SubTree1L, Child, ScopeDesc, PropertyDesc},
 deletekeywords={class,int,boolean,import,true,false, public, private, label,if, else},
 keywordstyle=\color{blue}\fontseries{b},
 numbers=left,
 numbersep=1em,
 numberstyle=\tiny, %\color{darkgray},
 commentstyle=\fontshape{n},%\color{green!70!black},
 %identifierstyle=\fontseries{b}\color{blue},
% stringstyle=\itshape, %\color{orange}, 
 tabsize=2,
 breaklines=true, % automatic line breaking
% keepspaces=false,
 breakatwhitespace=false, % break line at white space
 showstringspaces=false,	% remove space markers in strings
}

\lstdefinestyle{Jml}{
 xleftmargin=0.5cm,
% frame=lines,
 basicstyle=\jmltextsize\ttfamily,
 otherkeywords={requires, ensures, pure, \\result, \\old, invariant, initially, spec_public, non_null, assignable, assert, loop_invariant, decreasing},
 deletekeywords={class,int,boolean,import,true,false,public,private,label, if,else,this,new,break,return,null,static,final},
 keywordstyle=\color{blue}\fontseries{b},
 numbers=left,
 stepnumber=2,
% numbersep=1em,
 numberstyle=\fontshape{n}, %\color{darkgray},
 commentstyle=\fontshape{n},%\color{green!70!black},
 %identifierstyle=\fontseries{b}\color{blue},
% stringstyle=\itshape, %\color{orange}, 
 tabsize=2,
 breaklines=true, % automatic line breaking
% keepspaces=false,
% literate = *{\ \ }{\ }1, % reduce indentation from 4 spaces to 2 spaces
 breakatwhitespace=false, % break line at white space
 showstringspaces=false,	% remove space markers in strings
}

% listing style: Java presentation (used in presentation slides)
\lstdefinestyle{JavaListingPresent}{
 xleftmargin=0.5cm,
 frame=none,
 basicstyle=\javalistPresentTextSize\ttfamily,
 language=Java,
 otherkeywords={DClass, DAttr, DOpt, DAssoc, AttrRef,
                ModuleDesc, ModelDesc, ViewDesc, AttributeDesc, ControllerDesc, ContainmentTree},
 deletekeywords={class,int,boolean,import,private,true,false},
 keywordstyle=\color{blue}\fontseries{b},
 numbers=left,
 numbersep=5pt,
 numberstyle=\tiny\color{darkgray},
 commentstyle=\fontshape{n}, %\color{purple!40!black},
 %identifierstyle=\fontseries{b}\color{blue},
 stringstyle=\itshape, %\color{orange}, 
 showstringspaces=false,	% remove space markers in strings
}

%\lstset{
%% frame=lines,
% basicstyle=\codelistingtextsize\ttfamily,
%% otherkeywords={DClass, DAttr, DOpt, DAssoc, AttrRef,
%%                ModuleDesc, ModelDesc, ViewDesc, AttributeDesc, ControllerDesc, ContainmentTree},
%% deletekeywords={class,int,boolean,import,true,false, public, private, label},
% keywordstyle=\color{blue}\fontseries{b},
% numbers=left,
% stepnumber=2,
%% numbersep=1em,
%% numberstyle=\tiny, %\color{darkgray},
% commentstyle=\fontshape{n}\color{green!70!black},
% %identifierstyle=\fontseries{b}\color{blue},
% stringstyle=\itshape, %\color{orange}, 
% tabsize=2,
% breaklines=true, % automatic line breaking
%% keepspaces=false,
%% literate = *{\ \ }{\ }1, % reduce indentation from 4 spaces to 2 spaces
% breakatwhitespace=false % break line at white space
%}

% default listing style to use
\lstset{style=JavaListingNormal,basicstyle=\inlinetextsize\ttfamily}


\lstnewenvironment{lstcommand}{\lstset{style=JavaListingNormal,frame=none,numbers=none
} %
}{}

\lstnewenvironment{lstoutput}{\lstset{style=JavaListingNormal,frame=lines
} %
}{}

% #1: capture, #2: label
\lstnewenvironment{lstcode}[2]{ %\renewcommand{\lstlistingname}{Bản kê}% Listing -> Bản kê
\lstset{style=JavaListingNormal,frame=lines,language=Java,caption={#1},label={#2},captionpos=top,abovecaptionskip=-0.5em
} %
}{}

\lstnewenvironment{lstcodeinline}{
\lstset{style=JavaListingNormal,frame=none,numbers=none,language=Java} %
}{}

\lstnewenvironment{lstcodeinlinePresent}{
\lstset{style=JavaListingNormal,frame=none,numbers=none,language=Java,
basicstyle=\codeinlinetextsize\ttfamily,} %
}{}

\lstnewenvironment{lstothers}[2]{ %\renewcommand{\lstlistingname}{Bản kê}% Listing -> Bản kê
\lstset{style=JavaListingNormal,frame=lines,caption={#1},label={#2}
} %
}{}

% for listing rules like OCL 
\lstdefinestyle{RuleCellStyle}{
 xleftmargin=0.5cm,
% frame=none,	% % THIS RESULTS IN ERROR
 rulecolor=\color{white},
 basicstyle=\rulecelltextsize\ttfamily,
% language=OCL,
% otherkeywords={context,inv, and,not,if,then, else, endif, let, in, implies,exists,forall},
 otherkeywords={},
% keywordstyle=\color{blue}\fontseries{b},
% numbers=left,	% % THIS RESULTS IN ERROR
 numbersep=5pt,
 numberstyle=\tiny\color{darkgray},
 commentstyle=\fontshape{n}, %\color{purple!40!black},
 %identifierstyle=\fontseries{b}\color{blue},
 stringstyle=\itshape, %\color{orange}, 
 showstringspaces=false,	% remove space markers in strings
}

% for listing rules like OCL 
\lstdefinestyle{RuleStyle}{
 xleftmargin=0.5cm,
 frame=none,
% rulecolor=\color{white},
 basicstyle=\fontsize{8pt}{9.6pt}\ttfamily,
% language=OCL,
% otherkeywords={context,inv, and,not,if,then, else, endif, let, in, implies,exists,forall},
 keywords=, % no keyword highlighting
% keywordstyle=\color{blue}\fontseries{b},
% numbers=left,
 numbersep=5pt,
 numberstyle=\tiny\color{darkgray},
 commentstyle=\fontshape{n}, %\color{purple!40!black},
 %identifierstyle=\fontseries{b}\color{blue},
 % stringstyle=\itshape, %\color{orange}, 
 showstringspaces=false,	% remove space markers in strings 
}

\lstnewenvironment{lstrulecell}
  {\lstset{style=RuleCellStyle} %
  }
  {}

\lstnewenvironment{lstrule}
  {\lstset{style=RuleStyle} %
  }
  {}

% extension of lstrule to allow the escape sequence (@@)
\lstnewenvironment{lstrulex}
  {\lstset{style=RuleStyle,escapeinside={(@}{@)}
  }
  }
  {}
  
% % similar to lstrule but supports label and caption
% #1 = caption, #2 = label
\lstnewenvironment{lstrulelbl}[2]
  {\lstset{style=RuleStyle,caption={#1},label={#2},captionpos=top,abovecaptionskip=-0.5em} %
  }
  {}
 
\lstnewenvironment{lstruleinline}{
\lstset{style=RuleStyle,numbers=none} %
}{}
  
%
%\newenvironment{lstcode}{\begin{lstlisting}[\frame=lines,language=Java]
%}{\end{lstlisting}}
